% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% The Introduction:
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\fancychapter{Conclusions and Recommendations}
\label{cap:conclusions}

\section{Conclusions}

The present work aimed at introducing a framework where fluid-solid flow were treated with a minimum number of \textit{ad-hoc} ideas, cases with arbitrarily complex geometry were supported and very unsteady behavior presented little difficulty for the numerical approach. 

According to this general objective, a fully Lagrangian description, coupled with the meshless description of the \ac{SPH} and \ac{DEM} methods were adopted. A sound conceptual description of both the fluid phase and the contact mechanics problems was described. The conservation equations, closures and contact laws were subjected to the discretization, and a set of algebraic equations representing the original \ac{PDE} system was presented, together with a numerical strategy for solution and time integration. Several numerical solutions were compared to known solutions, derived from either analytical studies or experimental measurements. The model was applied to actual problems, at large scales, compiling completely novel data. This corresponds to scenarios that either by scale or nature of the flow, present difficulties in direct observation and recording, fully complying with the objectives of the dissertation.\\

Chapter \ref{cap:chapter-numerical} introduces the numerical discretization. Careful derivation of the basic properties of the numerical approximation were introduced, with a discussion on predictable sources of errors and accuracy. In Section \ref{sec:solid-discretization}, the fluid and solid models are made compatible by using a dual \ac{SPH}-\ac{DCDEM} description:
\begin{itemize}
\item Both fluid and solid are presented by the same numerical element, a \textit{particle};
\item Solid, rigid bodies are described by a collection of particles with special properties, as fixed relative positions and a dual nature (both \ac{SPH} and \ac{DEM}). Since this subset of particles can take any configuration desirable, the accuracy to which a real volume is described depends strongly on the resolution. On the other hand, solid volumes, shells or any other combination of the two is trivial to reproduce with a particulate description. After the initial approximation (the representation of the continuous object with a set of particles), physical quantities as mass and inertia tensor are exact and trivial to compute, independent of geometry;
\item At every pair wise interaction, a distinction is made: solid contact or fluid interface, corresponding to different contact forces being computed. By using a solid particle in the fluid equations, tensions are locally continuous and the solid-fluid interface is implicitly described.
\end{itemize}

Chapter \ref{cap:chapter_hpc} briefly describes the implementation of the numerical model. DualSPHysics is a collaborative effort to produce a high-quality and high-performance implementation. This Chapter provides insight into the difficulties of assuring that the code is as efficient as possible. The numerical complexity of particulate methods implies that large, repetitive calculations need to be performed. The \ac{CPU} implementation shares much of the common strategies in parallel \ac{HPC} codes. The \ac{GPU} implementation however, demands unique novel solutions to be explored, in order to achieve runtimes compatible with the time-scale of the problem at hand. The implementation for large machines using \ac{MPI} was described, and the major difficulties of the unfinished \ac{MPI}-\ac{CUDA} version for rigid bodies were discussed. \\


In Chapter \ref{cap:chapter_validation}, attempts at quantifying the quality of the obtained solutions were carried out. After an initial review of results obtained with DualSPHysics from highly transient free-surface flows, low $R_e$ flows with analytical solutions were studied:

\begin{itemize}
\item The laminar Hagen-Poiseuille and Couette flows provide a relevant metric of the accuracy of the method for flows where particles are not intensely disorganized. Since the flow is laminar most of the regular lattice, imposed as initial condition for position of the particles, is maintained, with slow deformations occurring;
\item Error for these flows is in the $1\%$ order, showing that the adopted Dynamic Boundary Conditions are capable of correctly reproducing a solid boundary for laminar flow conditions.
\item The standard Smagorinsky approach to the eddy-viscosity is known to introduce a net stress even in laminar flows, were the \ac{SPS} contribution should be null. The observed error hints that this value is residual and of no consequence to these computations.
\end{itemize}

Section \ref{sec:validation_dam_break} allows the comparison of the model with non-traditional experimental dam break measurements. The velocity field on the dam break was recovered using a heavily modified \ac{PIV} technique. The downward gate motion introduced interesting aspects in the experiments, since traditionally, upward gates are employed. The numerical solution followed the experimental conditions with precision: the same dimensions were used and the gate motion was reconstructed and rebuilt numerically. The numerical velocity fields present very good agreement with the experimental values, as well as the free-surface shape, along time. The largest deviations occur in the vertical velocity signal, were the largest doubts on the experimental procedure are also concentrated.

In Section \ref{sec:FB_validation}, the fluid-solid description is tested:

\begin{itemize}
\item Free-stream consistency tests indicate that the integrator described in Section \ref{sec:dt} is adequate to treat the two systems simultaneously, as expected. No errors are detected in the flow field, indicating that the interface is at least well balanced, no artificial repulsion-attraction forces are being developed in a free-stream regime;
\item The effectiveness of the $\delta$-\ac{SPH} term is studied as a mechanism to curb the creation of an artificial density gradient across the interface, due to an unbalance on the kernel completeness;
\item The model compares favorably to known solutions regarding free buoyancy problems with large density differences. The solutions are comparable to analytical solutions to simplified models and traditional mesh-based \ac{VOF} results, indicating that the viscous terms seem to correctly function under large variations of $R_e$ in very unsteady flows;
\item Original experimental data was compiled, allowing for direct comparisons of the behavior of the system. The results show an accurate solution is possible. It is hypothesized that, due to the small scale of the experimental set-up, forces such as surface tension may have more influence on the system and partly explain the error or the numerical solution;
\item Studying the equilibrium position of floating bodies subjected exclusively to buoyant forces, an interesting property of the discretization and the implementation is discussed: the solution appears to naturally avert states other than global stable equilibrium. Considering the large number of computations involved every time-step, it is trivial to conceive a small truncation error resulting in a small force unbalance in the system. Adding to the effects of the dynamic scheduling of the paralelization of thousands of threads in a \ac{GPU}, this small force contributes to the instabilization of a precarious local unstable equilibrium. The \ac{VOF} code used as a reference used a user-defined force to promote the instabilization.
\end{itemize}

Collision modeling is studied in Section \ref{sec:validation_dry_collision}. Experimental data compiled by \cite{Kruggel-Emden-2007} is used to compare the dependency of the restitution coefficients on the impact velocity, using a pendulum system with different materials. 

\begin{itemize}
\item The reproduced behavior is similar to the experimental data, for a sufficiently high impact velocity. The solutions corresponding to velocities lesser then $0.1$ ms$^{-1}$ do not seem to fit the trend of the experimental data, that shows $e_n\rightarrow1.0$ as $V_0\rightarrow0.0$. This behavior, expected to a certain degree as viscous, elastic waves and plastic deformation energy dissipation mechanisms depend on impact velocity, may be difficult to capture as it implies the recording of small velocities;
\item For higher $V_0$, $e_n$ seems to be correctly recovered. The model reproduces the restitution coefficients using known material parameters, and the viscous damper can be further calibrated, offering the possibility of fine-tuning the results for specific applications.
\end{itemize}

In an attempt to fulfill the core objectives of this dissertation, an experimental campaign was designed and carried out, as elaborated in Section \ref{sec:validation_exp}. A large scale dam break flow provided the highly unsteady setting, and cubes packed in complex configurations subjected to that flow were competent targets for modeling. The cubes introduced discontinuities in the flow, and were subjected to normal, friction, buoyant and drag forces. By employing several cameras and a series of markers, \ac{DTL} algorithms provided a means to track individual cubes as they moved trough the flume. 

\begin{itemize}
\item Single cube experiments, were the object is dragged in intermittent contact with the bottom of the flume, the correct recovery of the velocities implies that the net momentum transfer, considering both fluid forces and friction at the bottom, was mostly accurate;
\item In a pile of objects, the cube in contact with the bed presented a delay in initiation of motion, independently of resolution. Since other objects do not show this behavior, it is hypothesized that the frictional spring over estimates the static friction, due to the weight of the top cubes;
\item The top cube shows coherent behavior but an artifact is introduced in the vertical direction. The cube vibrates slightly, in what may be described as a consequence of the use of perfectly rigid bodies: the viscous damper is insufficient to filter all of the high frequency oscillations that arise when the cubes bellow begin to move;
\item A more elaborate configuration, the third set up showed that lateral motion in a cube not placed along the center line of the flume is well captured. 
\end{itemize}

Overall, the results showed that the method is capable of providing accurate solutions to highly non-linear problems, were less flexible approaches would suffer greatly with the deformation and fragmentation of the free-surface, as well as the discontinuous geometry of the cubes. A \ac{PIV} method allowed the derivation of the flow field immediately before the impact locus. The \ac{SPH} solution presents the same flow structures, indicating that the fluid to solid momentum transfer occurs in a similar fashion, given enough resolution.

Chapter \ref{cap:chapter_apps} provides an exploratory tour of actual scenarios where the application of the presented method may provide significant advantages. Most of all, these remain problems that, either by scale, complexity or both, are uncharted territory for resolved state-of-the art numerical solutions. The coastal geomorphology case, in Section \ref{sec:coastal_geomorphology}, introduces an innovative view on a necessarily multi-disciplinary subject. The possibility of modeling events derived from recorded time series in real geometries opens a new field. The inverse problem, of the one posed so far, may now be studied. This means that instead of mapping simplified conceptual models to the available data, specific events may be traced to configurations compatible with the ones currently observed. This simple shift entails the transition from applying fitting techniques to employing descriptive tool, with prediction capabilities that may support future research directions, as well as decision making.

Section \ref{sec:sines} embodies most of the questions raised by Section \ref{sec:coastal_geomorphology}, applying them in a larger and more visible domain: an industrial and shipping harbor. Physical modeling is of extreme importance to the design of the harbors and sea protection, but that accounts almost exclusively for infrastructure. The proposed model was applied to a section of a real harbor, recreating realistic functioning conditions, at an infinitesimal fraction of the cost of physical modeling. 

Finally, Section \ref{sec:debris_flow} takes a different stance. Experimental facilities are capable of reproducing averaged size debris flows, but, as previously discussed, measuring techniques are still difficult to put in place. Large amounts of data has been collected on global and macroscopic quantities of these flows: discharges, flow depths and average velocities. As such, the application of the present model stands between a novel application and a validation case. The model reproduced acceptably the available data, correctly recovering tendencies of retention rates by the checked-dam. In doing so, more information than available before on the mechanics of a debris flow was produced. New research prompts are bound to emerge, even considering the embryonic stage of the results.



\section{Recommendations for Future Developments}

The fluid discretization model presented in Chapter \ref{cap:chapter-numerical} is susceptible to a number of critiques. The \ac{WCSPH} formulation depends on the $\delta$-SPH term to stabilize the density field, and most importantly, to mitigate the effects of persistent entropy jumps, as shown in Section \ref{sec:Fluid/Solid Interfaces}. More robust $\delta$-SPH terms are available \citep{Antuono-2012}, at the expense of computational efficiency. Alternative implementation strategies could offset this cost, providing a balanced term that does not corrupt hydrostatic solutions and is less diffusive, better preserving steep gradients on the density field that are physically inspired. Regarding viscous stresses, the \ac{SPS} formulation used in this work relies on the outdated Smagorisnky model for the eddy viscosity definition. A Wall-Adapting Local Eddy-Viscosity (WALE) model could be used, effectively tackling two problems at once. The turbulent viscosities would be null for laminar regions and wall bounded flows would have a better approximation of eddy viscosity near the wall, without a stringing need for added resolution in that area. 

Variable resolution models \citep{Vacondio-2013} could provide impressive gains in terms of resolving the boundary layers around objects and solid walls, while optimizing the computational cost of the simulations. These schemes require careful implementation to ensure that no bottlenecks are introduced in the computation, now with a possibly varying number of particles per time step.

Boundary conditions are a major difficulty in \ac{SPH} models. The dynamic boundary conditions \citep{Crespo-2007}, used in the current version of DualSPHysics and in this work, provide unparalleled simplicity, both conceptual and computational, but introduce serious artifacts in the simulation. New strategies to approach boundary integrals, making them computationally accessible, should be devised as well as for new ghost particle stencil methods \citep{Fourtakas-2014}.  This would apply both to static boundaries and also to moving boundaries, such as floating bodies.

Regarding the rigid bodies described in this work, important energy dissipating mechanisms are not being taken into account. Considering elasto-plastic bodies would potentially expand on the potential applications of the model. Elasticity equations could be solved by SPH \citep{Cleary-2008}, in parallel with the momentum equations, resulting in a unified method. Impressive results using local maximum-entropy approximation schemes \citep{Arroyo-2006, Ortiz-2010}, a recent class of meshless methods suitable for trivial coupling with SPH, could also lead to a promising model.

A troubling issue with the presented model is the lack of effective lubrication forces between contacts once the distance between bodies is less than the fluid resolution. \cite{Potapov-2001} mentioned that only \textit{ad-hoc} ideas would be able to complete the model, such as the ones used in \cite{Kempe-2012}. These may provide aditional control over the quality of the results and the modelling possibilities of the code.

Regarding implementation issues, the MPI version of the code with floating bodies is not operational. The topological connectivity constraints that a body crossing between processes poses were exposed in Chapter \ref{cap:chapter_hpc}. Further optimizations are required and are under way.

\cleardoublepage